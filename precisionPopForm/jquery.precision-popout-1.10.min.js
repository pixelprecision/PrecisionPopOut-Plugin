function getTransformProperty(e){var t=["transform","WebkitTransform","MozTransform","msTransform","OTransform"];var n;while(n=t.shift()){if(e.style[n]!==undefined){return n}}return false}$.fn.precisionPopOut=function(e){var t={inlineCSS:false,markUpInc:true,blackOut:false,speed:.35,responsive:true,popup:false,popClickText:"Help",popOutDirection:"left",resWindowWidth:600,loadTweenMax:false,loadRotatePlugin:false,width:"70%",height:"100%",backgroundColor:"#465667",textColor:"#fff",padding:20,container:"#Container",clickBackground:"#ff3600",clickColor:"#fff",clickHeight:120,clickWidth:30,clickDefaultPos:"top",clickResPos:"bottom"};if(e){$.extend(t,e)}var n=t.speed*1e4;var r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return this.each(function(){var e=$(this);var r=$("body");var i,s,o;if(t.markUpInc==false){e.wrap('<div id="ppPopOut"></div>');e=e.parent();e.prepend('<div id="ppClose">X</div>');$('<div id="ppPopClick"><span class="ppPopText">'+t.popClickText+"</span></div>").insertAfter(e);console.log("Insert Before");i=e.next("#ppPopClick");s=i.find(".ppPopText");o=e.find("#ppClose")}else{i=$("#ppPopClick");s=$(".ppPopText");o=$("#ppClose")}if(t.blackOut==true){$('<div class="ppFadeOut"></div>').insertBefore(e);var u=$(".ppFadeOut");u.css({display:"none",opacity:0,height:"100%",width:"100%",position:"fixed",zIndex:98,background:"#333",top:0,left:0})}var a=e;var f=e.find("#ppClose");var l=$(t.container);var c=l.css("position");console.log("container position: "+c);if(t.loadTweenMax==true){var h=document.createElement("script");$(h).attr("src","http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js");$(h).appendTo("head")}i.setVertPos();var p=function(){if(t.popOutDirection=="top"){TweenMax.to(a,t.speed,{top:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(l,t.speed,{position:"relative",top:t.height})}else if(t.popOutDirection=="bottom"){TweenMax.to(a,t.speed,{bottom:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(l,t.speed,{position:"relative",bottom:t.height,top:"auto"})}else if(t.popOutDirection=="left"){TweenMax.to(a,t.speed,{left:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(l,t.speed,{position:"relative",left:t.width})}else{TweenMax.to(a,t.speed,{right:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(l,t.speed,{position:"relative",left:"-"+t.width})}r.css({overflow:"hidden"});if(t.blackOut){u.css({display:"block"});TweenMax.to(u,t.speed,{opacity:.7})}};var d=function(){if(t.popOutDirection=="top"){TweenMax.to(a,t.speed,{top:"-"+t.height});TweenMax.to(l,t.speed,{position:"relative",top:0})}else if(t.popOutDirection=="bottom"){TweenMax.to(a,t.speed,{bottom:"-"+t.height});TweenMax.to(l,t.speed,{position:"relative",bottom:0})}else if(t.popOutDirection=="left"){TweenMax.to(a,t.speed,{left:"-"+t.width});TweenMax.to(l,t.speed,{position:"relative",left:0})}else{TweenMax.to(a,t.speed,{right:"-"+t.width});TweenMax.to(l,t.speed,{position:"relative",left:0})}TweenMax.to(a,t.speed,{boxShadow:"none"});setTimeout(function(){r.css({overflow:"auto"})},n);if(t.blackOut){TweenMax.to(u,t.speed,{opacity:0});setTimeout(function(){u.css({display:"none"})},n)}};o.on("click",function(){i.click();v=0;console.log("Close Form")});var v=0;i.on("click",function(){if(v==0){console.log("Show Form, state= "+v);p();v=1;console.log("State= "+v)}else{console.log("Hide Form");d();v=0}console.log("Done")});var m=function(){if(t.clickDefaultPos=="top"){i.css({top:0,bottom:"auto",height:t.clickWidth,width:t.clickHeight});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,lineHeight:t.clickWidth+"px"})}else if(t.clickDefaultPos=="bottom"){i.css({bottom:0,top:"auto",height:t.clickWidth,width:t.clickHeight});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,lineHeight:t.clickWidth+"px"})}else if(t.clickDefaultPos=="left"){i.css({left:0,right:"auto",top:"auto",height:t.clickHeight,width:t.clickWidth});s.css({rotate:90,transformOrigin:"0 0",left:30,lineHeight:t.clickWidth+"px"});i.setVertPos()}else{i.css({right:0,left:"auto",top:"auto",height:t.clickHeight,width:t.clickWidth});s.css({rotate:90,transformOrigin:"0 0",left:30,lineHeight:t.clickWidth+"px"});i.setVertPos("right")}};var g=function(){if(t.clickResPos=="top"){i.css({top:0,bottom:"auto",height:t.clickWidth,width:t.clickHeight});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,lineHeight:t.clickWidth+"px"})}else if(t.clickResPos=="bottom"){i.css({bottom:0,top:"auto",height:t.clickWidth,width:t.clickHeight});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,lineHeight:t.clickWidth+"px"})}else if(t.clickResPos=="left"){i.css({left:0,right:"auto",top:"auto",height:t.clickHeight,width:t.clickWidth});i.setVertPos();s.css({rotate:90,transformOrigin:"0 0",left:30,lineHeight:t.clickWidth+"px"})}else{i.css({right:0,left:"auto",top:"auto",height:t.clickHeight,width:t.clickWidth});i.setVertPos();s.css({rotate:90,transformOrigin:"0 0",lineHeight:t.clickWidth+"px",left:30});i.setVertPos("right")}};var y=function(){if(t.popOutDirection=="top"){a.css({top:"-"+t.height,left:0})}else if(t.popOutDirection=="bottom"){a.css({bottom:"-"+t.height,left:0})}else if(t.popOutDirection=="left"){a.css({left:"-"+t.width,top:0})}else{a.css({right:"-"+t.width,top:0})}};var b=function(){a.css({display:"block",opacity:1,position:"fixed",height:t.height,width:t.width,background:t.backgroundColor,zIndex:9999,padding:t.padding,color:t.textColor,overflowY:"auto",boxSizing:"border-box"});f.css({display:"block",position:"absolute",top:0,right:0,height:50,width:50,fontSize:30,color:"#FFF",background:"#333",lineHeight:"50px",textAlign:"center",zIndex:999,cursor:"pointer"});s.css({display:"block",position:"relative",width:120,textAlign:"center",color:t.textColor,fontWeight:"bold",lineHeight:t.clickWidth+"px"});i.css({background:t.clickBackground,height:t.clickHeight,width:t.clickWidth,zIndex:99,position:"fixed",cursor:"pointer",color:t.clickColor});m();y();if($(window).width()<=t.resWindowWidth){i.css({zIndex:99,position:"fixed",cursor:"pointer",color:t.clickColor});g()}};if(t.inlineCSS==true){b()}if(t.responsive==true){b();$(window).resize(function(){b()})}})};$.cssHooks["rotate"]={get:function(e,t,n){var r=getTransformProperty(e);if(r){return e.style[r].replace(/.*rotate\((.*)deg\).*/,"$1")}else{return""}},set:function(e,t){var n=getTransformProperty(e);if(n){t=parseInt(t);$(e).data("rotation",t);if(t==0){e.style[n]=""}else{e.style[n]="rotate("+t%360+"deg)"}}else{return""}}};$.fx.step["rotate"]=function(e){$.cssHooks["rotate"].set(e.elem,e.now)};$.fn.setVertPos=function(e){var t=$(this);var n=($(window).height()-t.height())/2;console.log("Window Height = "+$(window).height()+", PopHeight = "+t.height()+", top position = "+n+", which direction = "+e);if(e=="right"){t.css({right:0,bottom:n,left:"auto"})}else{t.css({left:0,bottom:n})}};$.fn.setHorizPos=function(e){var t=$(this);var n=($(window).width()-t.width())/2;console.log("Window width = "+$(window).width()+", PopWidth = "+t.width()+", left position = "+n);if(e=="right"){t.css({right:n})}else{t.css({left:n})}}
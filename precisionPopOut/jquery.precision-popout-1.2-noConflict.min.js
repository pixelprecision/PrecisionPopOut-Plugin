/*!
 * VERSION: 1.2
 * DATE: 2014-03-13
 * UPDATES AND DOCS AT: http://www.pixelprecisionnw.com
 *
 * Includes all of the following: RotatePlugin, PrecisionPopout Plugin
 *
 * @license Copyright (c) 2011-2014, Pixel Precision. All rights reserved.
 * This work is subject to the terms at http://www.pixelprecisionnw.com/terms_of_use
 *
 * @author: Brenden Leib, brenden@pixelprecisionnw.com
 **/

function getTransformProperty(e){var t=["transform","WebkitTransform","MozTransform","msTransform","OTransform"];var n;while(n=t.shift()){if(e.style[n]!==undefined){return n}}return false}var $prec=jQuery;$prec.fn.precisionPopOut=function(e){var t={inlineCSS:false,popClass:"precisePop1",markUpInc:true,blackOut:false,speed:.35,responsive:true,popup:false,popClickText:"Help",popOutDirection:"left",resWindowWidth:600,loadTweenMax:false,loadRotatePlugin:false,width:"70%",height:"100%",backgroundColor:"#333",textColor:"#fff",padding:20,container:"#Container",clickBackground:"#ff3600",clickColor:"#fff",clickHeightH:30,clickWidthH:120,clickHeightV:120,clickWidthV:30,clickDefaultPos:"top",clickResPos:"bottom",clickRndCorners:false,clickRadius:0,closePos:"topRight",closeBackground:"none",closeColor:"#fff"};if(e){$prec.extend(t,e)}var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return this.each(function(){var e=t.speed*1e3;var n=$prec(this);var r=$prec("body");var i,s,o;if(t.markUpInc==false){n.wrap('<div id="precisionPopOut" class="'+t.popClass+'"></div>');n=n.parent();$prec("body").prepend(n);n.prepend('<div id="precisionClose">X</div>');$prec('<div id="precisionPopClick" class="'+t.popClass+'"><span class="precisionPopText">'+t.popClickText+"</span></div>").insertAfter(n);console.log("Insert Before");i=n.next("#precisionPopClick");s=i.find(".precisionPopText");o=n.find("#precisionClose")}else{i=$prec("#precisionPopClick");s=$prec(".precisionPopText");o=$prec("#precisionClose")}if(t.blackOut==true){$prec('<div class="precisionFadeOut"></div>').insertBefore(n);var u=$prec(".precisionFadeOut");u.css({display:"none",opacity:0,height:"100%",width:"100%",position:"fixed",zIndex:98,background:"#333",top:0,left:0})}var a=n;var o=n.find("#precisionClose");var f=$prec(t.container);var l=f.css("position");console.log("container position: "+l);if(t.loadTweenMax==true){var c=document.createElement("script");$prec(c).attr("src","http://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js");$prec(c).appendTo("head")}i.setVertPos();var h=function(){if(t.popOutDirection=="top"){TweenMax.to(a,t.speed,{top:0,boxShadow:"0 0 36px 3px #000"});f.css({position:"absolute"});TweenMax.to(f,t.speed,{top:t.height,bottom:"auto"})}else if(t.popOutDirection=="bottom"){TweenMax.to(a,t.speed,{bottom:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(f,t.speed,{position:"relative",bottom:t.height,top:"auto"})}else if(t.popOutDirection=="left"){TweenMax.to(a,t.speed,{left:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(f,t.speed,{position:"relative",left:t.width})}else{TweenMax.to(a,t.speed,{right:0,boxShadow:"0 0 36px 3px #000"});TweenMax.to(f,t.speed,{position:"relative",left:"-"+t.width})}r.css({overflow:"hidden"});if(t.blackOut){u.css({display:"block"});TweenMax.to(u,t.speed,{opacity:.7})}};var p=function(){if(t.popOutDirection=="top"){TweenMax.to(a,t.speed,{top:"-"+t.height});TweenMax.to(f,t.speed,{position:"relative",top:0})}else if(t.popOutDirection=="bottom"){TweenMax.to(a,t.speed,{bottom:"-"+t.height});TweenMax.to(f,t.speed,{position:"relative",bottom:0});setTimeout(function(){f.css({bottom:"auto"})},e*1.1)}else if(t.popOutDirection=="left"){TweenMax.to(a,t.speed,{left:"-"+t.width});TweenMax.to(f,t.speed,{position:"relative",left:0})}else{TweenMax.to(a,t.speed,{right:"-"+t.width});TweenMax.to(f,t.speed,{position:"relative",left:0})}TweenMax.to(a,t.speed,{boxShadow:"none"});setTimeout(function(){r.css({overflow:"auto"})},e*1.1);if(t.blackOut){TweenMax.to(u,t.speed,{opacity:0});setTimeout(function(){u.css({display:"none"})},e*1.1)}};o.on("click",function(){i.click();d=0;console.log("Close Form")});var d=0;i.on("click",function(){if(d==0){console.log("Show Form, state= "+d);h();d=1;console.log("State= "+d)}else{console.log("Hide Form");p();d=0}console.log("Done")});var v=function(){if(t.closePos=="btmMiddle"){o.css({bottom:0,right:"auto",left:"auto",top:"auto"});o.setHorizPos("null",true)}else if(t.closePos=="btmLeft"){o.css({top:"auto",right:"auto",left:"0",bottom:"0"})}else if(t.closePos=="btmRight"){o.css({top:"auto",right:"0",left:"auto",bottom:"0"})}else if(t.closePos=="topMiddle"){o.css({top:0,bottom:"auto"});o.setHorizPos("null",true)}else if(t.closePos=="topLeft"){o.css({top:0,right:"auto",left:"0",bottom:"auto"})}else if(t.closePos=="topRight"){o.css({top:"0",right:"0",left:"auto",bottom:"auto"})}};var m=function(){if(t.clickRndCorners==true){i.css({borderRadius:t.clickRadius})}};var g=function(){o.css({background:t.closeBackground,color:t.closeColor})};var y=function(){if(t.clickDefaultPos=="top"){i.css({top:0,bottom:"auto",height:t.clickHeightH,width:t.clickWidthH});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,width:t.clickWidthH,lineHeight:t.clickHeightH+"px"})}else if(t.clickDefaultPos=="bottom"){i.css({bottom:0,top:"auto",height:t.clickHeightH,width:t.clickWidthH});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,width:t.clickWidthH,lineHeight:t.clickHeightH+"px"})}else if(t.clickDefaultPos=="left"){i.css({left:0,right:"auto",top:"auto",height:t.clickHeightV,width:t.clickWidthV});s.css({rotate:90,WebkitTransformOrigin:"0 0",MsTransformOrigin:"0 0",transformOrigin:"0 0",left:t.clickWidthV,width:t.clickHeightV,lineHeight:t.clickWidthV+"px"});i.setVertPos()}else{i.css({right:0,left:"auto",top:"auto",height:t.clickHeightV,width:t.clickWidthV});s.css({rotate:90,WebkitTransformOrigin:"0 0",MsTransformOrigin:"0 0",transformOrigin:"0 0",left:t.clickWidthV,width:t.clickHeightV,lineHeight:t.clickWidthV+"px"});i.setVertPos("right")}};var b=function(){if(t.clickResPos=="top"){i.css({top:0,bottom:"auto",height:t.clickHeightH,width:t.clickWidthH});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,width:t.clickWidthH,lineHeight:t.clickHeightH+"px"})}else if(t.clickResPos=="bottom"){i.css({bottom:0,top:"auto",height:t.clickHeightH,width:t.clickWidthH});i.setHorizPos();s.css({rotate:0,transformOrigin:"0 0",left:0,width:t.clickWidthH,lineHeight:t.clickHeightH+"px"})}else if(t.clickResPos=="left"){i.css({left:0,right:"auto",top:"auto",height:t.clickHeightV,width:t.clickWidthV});i.setVertPos();s.css({rotate:90,WebkitTransformOrigin:"0 0",MsTransformOrigin:"0 0",transformOrigin:"0 0",left:t.clickWidthV,width:t.clickHeightV,lineHeight:t.clickWidthV+"px"})}else{i.css({right:0,left:"auto",top:"auto",height:t.clickHeightV,width:t.clickWidthV});i.setVertPos();s.css({rotate:90,WebkitTransformOrigin:"0 0",MsTransformOrigin:"0 0",transformOrigin:"0 0",lineHeight:t.clickHeightV+"px",left:t.clickWidthV,width:t.clickHeightV});i.setVertPos("right")}};var w=function(){if(t.popOutDirection=="top"){a.css({top:"-"+t.height,left:0})}else if(t.popOutDirection=="bottom"){a.css({bottom:"-"+t.height,left:0})}else if(t.popOutDirection=="left"){a.css({left:"-"+t.width,top:0})}else{a.css({right:"-"+t.width,top:0})}};var E=function(){a.css({display:"block",opacity:1,position:"fixed",height:t.height,width:t.width,background:t.backgroundColor,zIndex:999999,padding:t.padding,color:t.textColor,overflowY:"auto",boxSizing:"border-box",MozBoxSizing:"border-box",webkitBoxSizing:"border-box"});o.css({display:"block",position:"absolute",height:50,width:50,fontSize:40,color:"#FFF",background:"#333",lineHeight:"50px",textAlign:"center",zIndex:999,cursor:"pointer"});s.css({display:"block",position:"relative",textAlign:"center",color:t.textColor,fontWeight:"bold",lineHeight:t.clickWidth+"px"});i.css({background:t.clickBackground,zIndex:99999,position:"fixed",cursor:"pointer",color:t.clickColor});y();w();v();m();g();if($prec(window).width()<=t.resWindowWidth){i.css({zIndex:99,position:"fixed",cursor:"pointer",color:t.clickColor});b()}};if(t.inlineCSS==true){E()}if(t.responsive==true){E();$prec(window).resize(function(){E()})}})};$prec.cssHooks["rotate"]={get:function(e,t,n){var r=getTransformProperty(e);if(r){return e.style[r].replace(/.*rotate\((.*)deg\).*/,"$prec1")}else{return""}},set:function(e,t){var n=getTransformProperty(e);if(n){t=parseInt(t);$prec(e).data("rotation",t);if(t==0){e.style[n]=""}else{e.style[n]="rotate("+t%360+"deg)"}}else{return""}}};$prec.fx.step["rotate"]=function(e){$prec.cssHooks["rotate"].set(e.elem,e.now)};$prec.fn.setVertPos=function(e){var t=$prec(this);var n=($prec(window).height()-t.height())/2;console.log("Window Height = "+$prec(window).height()+", PopHeight = "+t.height()+", top position = "+n+", which direction = "+e);if(e=="right"){t.css({right:0,bottom:n,left:"auto"})}else{t.css({left:0,bottom:n})}};$prec.fn.setHorizPos=function(e,t){var n=$prec(this);var r=($prec(window).width()-n.width())/2;if(t==true){r=(n.parent().width()-n.width())/2}console.log("Window width = "+$prec(window).width()+", PopWidth = "+n.width()+", left position = "+r);if(e=="right"){n.css({right:r})}else{n.css({left:r})}}